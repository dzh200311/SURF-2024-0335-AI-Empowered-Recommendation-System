<!DOCTYPE html>
<html lang="en" xmlns:th="www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="log.css" />
    <title>User Authentication</title>
    <style>
      .privacy-policy-check {
        margin-top: 10px;
      }
      .privacy-policy-check label {
        margin-left: 5px;
        font-size: .9rem;
      }
    </style>
</head>
<body>
<div class="container2 sign-up-mode">
    <div class="forms-container">
        <div class="signin-signup">
            <!-- Log In Form -->
            <form class="sign-in-form" id="login" method="POST" th:action="@{/log_in}" th:object="${user}">
                <h2 class="title">Log In</h2>
                <div class="input-field">
                    <i class="bi bi-person"></i>
                    <input type="text" placeholder="Username" th:field="*{username}" required/>
                </div>
                <div class="input-field">
                    <i class="bi bi-key"></i>
                    <input type="password" placeholder="Password" th:field="*{password}" required/>
                </div>
                <div style="position: relative; width: 100%; max-width: 380px; margin-bottom: 20px;">
                    <a href="account-recovery" style="position: absolute; left: 5px;">Trouble logging in?</a>
                    <a href="#staticBackdrop" data-bs-toggle="modal" style="position: absolute; right: 5px;">Login as manager?</a>
                </div>
                <div class="privacy-policy-check">
                    <input type="checkbox" id="privacyPolicyCheck" required>
                    <label for="privacyPolicyCheck">I have read and agree to <a href="privacy.html">the Privacy Policy</a></label>
                </div>
                <input type="submit" value="Log In" class="btn2 solid" />
                <div th:if="${loginerror}" class="alert alert-danger" role="alert">
                    <p th:text="${loginerror}"></p>
                </div>
            </form>

            <!-- Sign Up Form -->
            <form class="sign-up-form" id="signup" method="POST" th:action="@{/add_user}" th:object="${user}">
                <h2 class="title">Sign Up</h2>
                <div class="input-field">
                    <i class="bi bi-person"></i>
                    <input type="text" placeholder="Username" th:field="*{username}" required/>
                </div>
                <div class="input-field">
                    <i class="bi bi-envelope"></i>
                    <input type="email" placeholder="Email" th:field="*{email}" required/>
                </div>
                <div class="input-field">
                    <i class="bi bi-key"></i>
                    <input type="password" placeholder="Password" th:field="*{password}" required/>
                </div>
                <div class="input-field">
                    <i class="bi bi-person-badge"></i>
                    <select th:field="*{role}" required>
                        <option value="" disabled selected>Select Role</option>
                        <option value="student">Student</option>
                        <option value="teacher">Teacher</option>
                    </select>
                </div>
                <input type="submit" class="btn2" value="Sign Up" />
                <div th:if="${success}" class="alert alert-success" role="alert">
                    <p th:text="${success}"></p>
                </div>
                <div th:if="${error}" class="alert alert-danger" role="alert">
                    <p th:text="${error}"></p>
                </div>
            </form>
        </div>
    </div>

    <div class="panels-container">
        <div class="panel left-panel">
            <div class="content">
                <h3>Don't have an account?</h3>
                <p>Sign up now and start your journey today!</p>
                <button class="btn2 transparent" id="sign-up-btn">Sign Up Now</button>
            </div>
            <img src="logIn.svg" class="image" alt="" />
        </div>
        <div class="panel right-panel">
            <div class="content">
                <h3>Already have an account?</h3>
                <p>Log in to access your personalized dashboard!</p>
                <button class="btn2 transparent" id="sign-in-btn">Log In Now</button>
            </div>
            <img src="register.svg" class="image" alt="" />
        </div>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5 w-100 text-center" id="staticBackdropLabel">Manager Login</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body d-flex flex-column align-items-center">
                <form id="admin_log_in" th:action="@{/admin_log_in}" method="POST" th:object="${manager}" style="width: 100%;">
                    <div class="input-field">
                        <i class="bi bi-person"></i>
                        <input type="text" placeholder="Username (for managers only)" th:field="*{name}" required/>
                    </div>
                    <div class="input-field">
                        <i class="bi bi-key"></i>
                        <input type="password" placeholder="Password" th:field="*{password}" required/>
                    </div>
                </form>
            </div>
            <div class="modal-footer justify-content-center">
                <button type="button" class="btn btn-outline-danger rounded-4" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" form="admin_log_in" class="btn btn-outline-success rounded-4">Login</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script src="app.js"></script>
</body>
</html>
